{"ast":null,"code":"import _objectSpread from\"/home/johnrijoy/projects/polling-webapp/pollo_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/johnrijoy/projects/polling-webapp/pollo_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import axios from'axios';import{Form,Button}from'react-bootstrap';import{Context}from'../context/appContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Pollform=function Pollform(props){var store=useContext(Context).store;var _useState=useState({poll_id:props.poll.polldata.poll_id}),_useState2=_slicedToArray(_useState,2),option=_useState2[0],setOption=_useState2[1];var handleRadio=function handleRadio(event){setOption(_objectSpread(_objectSpread({},option),{},{option_id:event.target.value}));console.log('option set as:',event.target.value,props.poll.polloptions[event.target.value]);};var handleSubmit=function handleSubmit(e){e.preventDefault();var vote=option;var opts={method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+store.token},data:JSON.stringify(vote)};console.log(opts);axios(process.env.REACT_APP_API_SERVER+\"/api/polls/votepoll\",opts).then(function(resp){if(resp.status===200)console.log('voted successfully');props.setchanged(!props.changed);if(resp.status===400)console.log('already voted');}).catch(function(error){console.error('caught error',error.response.data.msg);props.setchanged(!props.changed);});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{children:props.poll.polldata.question}),/*#__PURE__*/_jsx(Form.Group,{onChange:handleRadio,children:Object.entries(props.poll.polloptions).map(function(key,i){return/*#__PURE__*/_jsx(Form.Check,{name:\"option\",type:\"radio\",label:key[1],value:key[0]});})}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",children:\"Submit\"})]})});};export default Pollform;","map":{"version":3,"sources":["/home/johnrijoy/projects/polling-webapp/pollo_frontend/src/components/Pollform.js"],"names":["React","useState","useContext","axios","Form","Button","Context","Pollform","props","store","poll_id","poll","polldata","option","setOption","handleRadio","event","option_id","target","value","console","log","polloptions","handleSubmit","e","preventDefault","vote","opts","method","headers","token","data","JSON","stringify","process","env","REACT_APP_API_SERVER","then","resp","status","setchanged","changed","catch","error","response","msg","question","Object","entries","map","key","i"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport axios from 'axios';\n\nimport {\n  Form,\n  Button\n} from 'react-bootstrap';\n\nimport { Context } from '../context/appContext';\n\nconst Pollform = (props) => {\n  const store = useContext(Context).store;\n  const [ option, setOption ] = useState({\n    poll_id: props.poll.polldata.poll_id\n  });\n  \n  const handleRadio = (event) => {\n    setOption({...option, option_id : event.target.value});\n    console.log('option set as:', event.target.value, props.poll.polloptions[event.target.value]);\n  };\n\n  const handleSubmit = (e)=>{\n    e.preventDefault();\n    const vote = option;\n    const opts={\n      method: \"POST\",\n      headers: {\n        \"Content-Type\":\"application/json\",\n        \"Authorization\": \"Bearer \"+ store.token\n      },\n      data: JSON.stringify(vote)\n    };\n\n    console.log(opts);\n    axios(process.env.REACT_APP_API_SERVER+\"/api/polls/votepoll\", opts)\n      .then((resp)=>{\n        if (resp.status === 200)\n          console.log('voted successfully');\n          props.setchanged(!props.changed)\n        if (resp.status === 400)\n          console.log('already voted');\n\n      }).catch((error)=>{\n        console.error('caught error', error.response.data.msg);\n        props.setchanged(!props.changed) \n      })\n    \n\n  }\n\n  return (\n    <>\n    <Form onSubmit={handleSubmit}>\n      <h1>{props.poll.polldata.question}</h1>\n      <Form.Group onChange={handleRadio}>\n      {Object.entries(props.poll.polloptions).map((key, i)=>\n                (\n                  <Form.Check\n                    name=\"option\"\n                    type=\"radio\"\n                    label={key[1]}\n                    value={key[0]}\n                  />\n                )\n        ) \n      }\n      </Form.Group>\n      <Button variant=\"primary\" type=\"submit\">\n        Submit\n      </Button>\n    </Form>\n    </>\n  )\n}\n\nexport default Pollform;\n"]},"metadata":{},"sourceType":"module"}