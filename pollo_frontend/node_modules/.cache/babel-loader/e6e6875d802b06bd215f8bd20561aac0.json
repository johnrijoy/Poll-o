{"ast":null,"code":"import _slicedToArray from\"/home/johnrijoy/projects/polling-webapp/pollo_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useEffect}from\"react\";import axios from'axios';import{useParams,useHistory}from'react-router-dom';import{Card,Row,Col,Form}from'react-bootstrap';import{Layout}from'../layout/Layout';import{Context}from'../context/appContext';import{Pollform,Pollstatus}from'../components';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Pollpage=function Pollpage(){var _useParams=useParams(),poll_id=_useParams.poll_id;var history=useHistory();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),changed=_useState4[0],setChanged=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),poll=_useState6[0],setPoll=_useState6[1];var token=useContext(Context).store.token;console.log('poll id received:',poll_id,token);useEffect(function(){var opts={method:\"GET\",headers:{\"Accept\":\"application/json\",\"Authorization\":\"Bearer \"+token},params:{\"poll_id\":poll_id}};axios.get(process.env.REACT_APP_API_SERVER+\"/api/polls/getpoll\",opts).then(function(resp){if(resp.status===200){setPoll(resp.data);setLoading(false);}}).catch(function(error){console.error(\"error in getpoll:\",error);if(error.response.status===422||error.response.status===401)history.push('/login');});},[changed,token,poll_id,history]);console.log(poll);return/*#__PURE__*/_jsx(Layout,{heading:\"Poll'O\",children:loading?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading\"})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Card,{className:\"text-center h2\",body:true,children:poll.polldata.question})}),/*#__PURE__*/_jsxs(Row,{className:\"justify-content-center\",children:[!poll.polldata.attempted&&/*#__PURE__*/_jsx(Col,{className:\"col-md-6\",children:/*#__PURE__*/_jsx(Pollform,{poll:poll,changed:changed,setchanged:setChanged})}),/*#__PURE__*/_jsx(Col,{className:\"col-md-6\",children:/*#__PURE__*/_jsx(Pollstatus,{poll:poll})})]}),/*#__PURE__*/_jsx(Row,{className:\"justify-content-center text-center\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Form.Group,{as:Row,className:\"mb-3 justify-content-center\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",children:\"Share Link\"}),/*#__PURE__*/_jsx(Col,{sm:\"4\",children:/*#__PURE__*/_jsx(Form.Control,{plaintext:true,readOnly:true,defaultValue:window.location.href})})]})})})]})});};export default Pollpage;","map":{"version":3,"sources":["/home/johnrijoy/projects/polling-webapp/pollo_frontend/src/pages/Pollpage.js"],"names":["React","useState","useContext","useEffect","axios","useParams","useHistory","Card","Row","Col","Form","Layout","Context","Pollform","Pollstatus","Pollpage","poll_id","history","loading","setLoading","changed","setChanged","poll","setPoll","token","store","console","log","opts","method","headers","params","get","process","env","REACT_APP_API_SERVER","then","resp","status","data","catch","error","response","push","polldata","question","attempted","window","location","href"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport axios from 'axios';\nimport { useParams, useHistory } from 'react-router-dom';\nimport {\n  Card,\n  Row,\n  Col,\n  Form\n} from 'react-bootstrap';\n\nimport { Layout } from '../layout/Layout';\nimport { Context } from '../context/appContext';\nimport { \n  Pollform,\n  Pollstatus\n} from '../components';\n\nconst Pollpage = () => {\n  const { poll_id } = useParams();\n  const history = useHistory();\n  const [ loading, setLoading ] = useState(true);\n  const [ changed, setChanged ] = useState(false);\n  const [ poll, setPoll ] = useState(null);\n  const token = useContext(Context).store.token;\n  \n  console.log('poll id received:',poll_id, token);\n  \n  useEffect(()=> {\n    \n  const opts = {\n      method: \"GET\",\n      headers: {\n        \"Accept\":\"application/json\",\n        \"Authorization\": \"Bearer \"+ token\n      },\n      params: {\"poll_id\":poll_id}\n  }\n  axios.get(process.env.REACT_APP_API_SERVER+\"/api/polls/getpoll\", opts)\n    .then((resp)=>{\n      if (resp.status === 200){\n      setPoll(resp.data);\n      setLoading(false);\n      }\n    }).catch((error)=>{\n      console.error(\"error in getpoll:\", error);\n      if (error.response.status === 422 || error.response.status === 401)\n        history.push('/login');\n    });\n  }, [changed, token, poll_id, history])\n  console.log(poll);\n\n  return (\n    <Layout heading=\"Poll'O\">\n    {loading ? (\n        <>\n        <p>Loading</p>\n        </>\n      ):(\n        <>\n        <Row>\n          <Card className=\"text-center h2\" body>{poll.polldata.question}</Card>\n        </Row>\n        <Row className=\"justify-content-center\">\n        { !poll.polldata.attempted &&\n          <Col className=\"col-md-6\">\n            <Pollform poll = {poll} changed={changed} setchanged={setChanged}/>\n          </Col>\n        }\n        <Col className=\"col-md-6\">\n          <Pollstatus poll = {poll} />\n        </Col>\n        </Row>\n\n        <Row className=\"justify-content-center text-center\">\n        <Col>\n          <Form.Group as={Row} className=\"mb-3 justify-content-center\" >\n            <Form.Label column sm=\"2\">\n               Share Link \n            </Form.Label>\n            <Col sm=\"4\">\n              <Form.Control plaintext readOnly defaultValue={window.location.href} />\n            </Col>\n          </Form.Group>\n        </Col>\n\n        </Row>\n        </>\n      )\n    }\n    </Layout>\n  );\n};\n\nexport default Pollpage;\n"]},"metadata":{},"sourceType":"module"}